#
# Meadow.Daemon Configuration File
#
# This file is installed by the mc-daemon package.
# Edit settings as needed and restart the service:
#   sudo systemctl restart mc-daemon
#
# For detailed documentation, see:
#   https://github.com/WildernessLabs/Meadow.Daemon
#

# ============================================================================
# SERVICE SETTINGS
# ============================================================================

# Enable cloud connectivity
enabled yes

# Enable MQTT listener for update notifications
enable_mqtt_listener yes

# ============================================================================
# PATH SETTINGS
# ============================================================================

# Application root directory (where updates are applied)
meadow_root /opt/meadow

# Temporary operations root (downloads, extractions, staging)
meadow_temp /tmp/meadow

# ============================================================================
# REST API SETTINGS
# ============================================================================

# REST API bind address (localhost only for security)
# Use 0.0.0.0 only for development/testing
rest_api_bind_address 127.0.0.1

# ============================================================================
# UPDATE SERVER SETTINGS (MQTT)
# ============================================================================

# Meadow.Cloud MQTT broker
update_server_address tcp://mqtt.meadowcloud.co

# MQTT port
update_server_port 1883

# ============================================================================
# AUTHENTICATION SETTINGS
# ============================================================================

# Use authentication with Meadow.Cloud
use_authentication yes

# Authentication server
auth_server_address https://www.meadowcloud.co
auth_server_port 443

# Maximum authentication retry attempts
auth_max_retries 10

# ============================================================================
# MQTT TOPIC SETTINGS
# ============================================================================

# MQTT topics to subscribe to
# {OID} = Organization ID, {ID} = Machine ID
mqtt_topics {OID}/ota/{ID}

# Automatically download updates when published
auto_download_updates no

# ============================================================================
# TIMING SETTINGS
# ============================================================================

# Reconnection retry interval (seconds)
connect_retry_seconds 15

# Application exit timeout during update (seconds)
update_apply_timeout_seconds 300

# ============================================================================
# APPLICATION RESTART SETTINGS
# ============================================================================

# Is the application a systemd service?
app_is_systemd_service no

# Service name (required if app_is_systemd_service=yes)
#app_service_name meadow-app.service

# ============================================================================
# NOTES
# ============================================================================
#
# SSH Keys: The daemon uses /root/.ssh/id_rsa for cloud authentication.
# These are auto-generated during package installation if not present.
#
# REST API: Available at http://127.0.0.1:5000/api
#   GET  /api/info       - Daemon information
#   GET  /api/updates    - List updates
#   PUT  /api/updates/{id} - Download/apply update
#   DELETE /api/updates  - Clear updates
#
# Logs: View with: journalctl -u mc-daemon -f
#
